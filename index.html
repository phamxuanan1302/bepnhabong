<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bếp Nhà Bông - Đặt hàng online</title>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&family=Pacifico&display=swap" rel="stylesheet">
<style>
:root{--pink:#FFB6C1;--hotpink:#FF69B4;--lightpink:#FFF0F5;--text:#D81B60;}
*{margin:0;padding:0;box-sizing:border-box;}
body{font-family:'Montserrat',sans-serif;background:linear-gradient(135deg,#fdf,#fff0f5);background-image:repeating-linear-gradient(45deg,transparent,transparent 35px,rgba(255,182,193,.05) 35px,rgba(255,182,193,.05) 70px),repeating-linear-gradient(-45deg,transparent,transparent 35px,rgba(255,182,193,.05) 35px,rgba(255,182,193,.05) 70px);min-height:100vh;padding:15px 10px;color:#333;}
.container{max-width:1000px;margin:0 auto;text-align:center;}
.logo img{width:110px;border-radius:50%;border:6px solid var(--pink);margin-bottom:8px;}
h1{font-family:'Pacifico',cursive;font-size:3.8em;color:var(--hotpink);text-shadow:4px 4px 0 #ffebee;margin:10px 0 5px;}
.subtitle{font-size:1.4em;color:var(--text);font-weight:600;margin-bottom:30px;}
.products{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:28px;margin-bottom:50px;}
.product{background:white;border-radius:30px;overflow:hidden;box-shadow:0 12px 35px rgba(255,105,180,.18);padding:22px;transition:.35s;}
.product:hover{transform:translateY(-12px);}
.product img{width:190px;height:190px;object-fit:cover;border-radius:50%;border:9px solid var(--pink);margin-bottom:15px;}
.product h3{font-family:'Pacifico',cursive;font-size:1.85em;color:var(--text);margin:12px 0;}
.price{font-weight:700;font-size:1.55em;color:var(--hotpink);margin:8px 0;}
.add-btn{margin-top:15px;background:linear-gradient(45deg,#FF69B4,#FF1493);color:white;border:none;padding:15px 30px;border-radius:35px;font-weight:600;cursor:pointer;width:100%;font-size:1.25em;transition:.3s;}
.add-btn:hover{transform:scale(1.06);box-shadow:0 8px 20px rgba(255,105,180,.4);}
.cart-form{background:white;border-radius:35px;padding:35px;box-shadow:0 18px 50px rgba(255,105,180,.22);margin-top:20px;}
.cart-title{font-family:'Pacifico',cursive;font-size:2.6em;color:var(--hotpink);margin:20px 0;}
.cart-item{display:flex;align-items:center;background:var(--lightpink);padding:16px;border-radius:22px;margin-bottom:14px;}
.cart-item img{width:72px;height:72px;border-radius:50%;border:5px solid var(--pink);margin-right:16px;}
.quantity{display:flex;align-items:center;gap:16px;background:white;padding:6px 18px;border-radius:35px;margin-left:auto;}
.quantity button{width:38px;height:38px;border:none;background:var(--hotpink);color:white;border-radius:50%;font-size:1.4em;cursor:pointer;}
.total{text-align:right;font-size:2em;font-weight:700;color:var(--text);margin:30px 0;}
.form-group{margin  margin-bottom:20px;position:relative;}
.form-group input,.form-group textarea{width:100%;padding:16px;border:3px solid var(--pink);border-radius:22px;font-size:1.15em;transition:.3s;}
.form-group input:focus,.form-group textarea:focus{outline:none;border-color:var(--hotpink);box-shadow:0 0 0 4px rgba(255,105,180,.2);}
.error-msg{color:#e74c3c;font-size:0.95em;margin-top:5px;display:none;position:absolute;bottom:-22px;left:0;}
.submit-btn{background:linear-gradient(45deg,#FF1493,#FF69B4);color:white;border:none;padding:20px;border-radius:35px;font-size:1.7em;font-weight:700;width:100%;cursor:pointer;margin-top:30px;transition:.3s;}
.submit-btn:hover{transform:translateY(-4px);box-shadow:0 12px 30px rgba(255,20,147,.4);}
.success{background:#d4edda;color:#155724;padding:22px;border-radius:22px;text-align:center;font-size:1.35em;font-weight:600;display:none;margin-top:25px;}
</style>
</head>
<body>

<div class="container">
  <div class="logo">
    <img src="https://i.ibb.co/6cYQRnB/logo.png" alt="Bếp Nhà Bông">
  </div>
  <h1>Bếp Nhà Bông</h1>
  <p class="subtitle">Sữa chua · Bánh flan · Panna cotta nhà làm</p>

  <div class="products" id="productList"></div>

  <div class="cart-form">
    <h2 class="cart-title">Giỏ hàng của bạn</h2>
    <div id="cartItems"></div>
    <div class="total">Tổng tiền: <span id="totalPrice">0</span>đ</div>

    <h2 class="cart-title" style="margin-top:45px;">Thông tin nhận hàng</h2>
    <div class="form-group"><input type="text" id="name" placeholder="Họ và tên" required></div>
    <div class="form-group">
      <input type="text" id="phone" placeholder="Số điện thoại (bắt đầu bằng 0, 10 số)" maxlength="10" required>
      <div class="error-msg" id="phoneError">Số điện thoại phải có 10 số và bắt đầu bằng 0 (ví dụ: 0901234567)</div>
    </div>
    <div class="form-group"><input type="text" id="address" placeholder="Địa chỉ giao hàng chi tiết" required></div>
    <div class="form-group"><textarea id="note" rows="3" placeholder="Ghi chú (ít đường, giao chiều...)" style="resize:none;"></textarea></div>

    <button class="submit-btn" onclick="submitOrder()">GỬI ĐƠN NGAY</button>
   <div class="success" id="successMsg">
  Đơn hàng đã gửi thành công!<br>Shop sẽ gọi xác nhận trong 5-10 phút nha
</div>
  </div>
</div>

<script>
// LINK WEB APP CỦA BẠN (đã đúng)
const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbzE7zwhZDAf6XqX2VcHy9kGlmAWiYDJcuURefpyRkS7tRNOliQdQZ1GgEhHuumT8UE1WA/exec";

const products = [
  { id:1, name:"Sữa chua truyền thống", price:10000, img:"https://i.imgur.com/2XbYk8L.jpg" },
  { id:2, name:"Sữa chua phô mai", price:13000, img:"https://i.imgur.com/2XbYk8L.jpg" },
  { id:3, name:"Sữa chua phô mai đặc biệt", price:15000, img:"https://i.imgur.com/2XbYk8L.jpg" },
  { id:4, name:"Sữa chua phô mai cam", price:15000, img:"https://i.imgur.com/2XbYk8L.jpg" },
  { id:5, name:"Bánh flan lớn", price:15000, img:"https://i.imgur.com/3qR9pLm.jpg" },
  { id:6, name:"Bánh flan nhỏ", price:8000, img:"https://i.imgur.com/3qR9pLm.jpg" },
  { id:7, name:"Panna cotta dâu tây", price:16000, img:"https://i.imgur.com/8vWqK8j.jpg" },
  { id:8, name:"Panna cotta chanh dây", price:16000, img:"https://i.imgur.com/8vWqK8j.jpg" },
  { id:9, name:"Panna cotta xoài", price:16000, img:"https://i.imgur.com/8vWqK8j.jpg" },
  { id:10,name:"Panna cotta phúc bồn tử", price:16000, img:"https://i.imgur.com/8vWqK8j.jpg" }
];

let cart = [];

// Render sản phẩm
document.getElementById("productList").innerHTML = products.map(p => `
  <div class="product">
    <img src="${p.img}" alt="${p.name}">
    <h3>${p.name}</h3>
    <div class="price">${p.price.toLocaleString()}đ</div>
    <button class="add-btn" onclick="addToCart(${p.id})">Thêm vào giỏ</button>
  </div>
`).join('');

function addToCart(id) {
  const item = products.find(p => p.id === id);
  const exist = cart.find(x => x.id === id);
  if (exist) exist.qty++; else cart.push({...item, qty:1});
  updateCart();
}

function updateCart() {
  const container = document.getElementById("cartItems");
  container.innerHTML = "";
  let total = 0;
  cart.forEach(item => {
    total += item.price * item.qty;
    container.innerHTML += `
      <div class="cart-item">
        <img src="${item.img}" alt="${item.name}">
        <div style="flex:1;text-align:left;">
          <strong>${item.name}</strong><br>${item.price.toLocaleString()}đ
        </div>
        <div class="quantity">
          <button onclick="changeQty(${item.id},-1)">−</button>
          <span>${item.qty}</span>
          <button onclick="changeQty(${item.id},1)">+</button>
        </div>
      </div>`;
  });
  document.getElementById("totalPrice").textContent = total.toLocaleString();
}

function changeQty(id, delta) {
  const item = cart.find(x => x.id === id);
  if (item) {
    item.qty += delta;
    if (item.qty <= 0) cart = cart.filter(x => x.id !== id);
    updateCart();
  }
}

// Kiểm tra SĐT chính xác 10 số, bắt đầu bằng 0
function submitOrder() {
  const name = document.getElementById("name").value.trim();
  const phone = document.getElementById("phone").value.trim();
  const address = document.getElementById("address").value.trim();
  const note = document.getElementById("note").value.trim();

  if (!name || !phone || !address || cart.length === 0) {
    alert("Vui lòng điền đầy đủ thông tin và chọn món nhé!");
    return;
  }
  if (!/^0[35789]\d{8}$/.test(phone)) {
    document.getElementById("phoneError").style.display = "block";
    return;
  } else {
    document.getElementById("phoneError").style.display = "none";
  }

  const itemsArray = cart.map(i => ({name:i.name, qty:i.qty, price:i.price}));
  const total = cart.reduce((s,i) => s + i.price*i.qty, 0);

  const data = {
    timestamp: new Date().toLocaleString("vi-VN"),
    name, phone, address, note,
    total: total.toLocaleString() + "đ",
    itemsArray
  };

  fetch(WEB_APP_URL, {
    method: "POST",
    mode: "no-cors",
    headers: {"Content-Type": "application/json"},
    body: JSON.stringify(data)
  })
  .then(() => fetch(WEB_APP_URL + "?print")) // gọi GET với tham số print
  .then(r => r.text())
  .then(url => {
    if (url.startsWith("http")) {
      const win = window.open(url, "_blank");
      setTimeout(() => win && win.print(), 3000);
    }
    document.getElementById("successMsg").style.display = "block";
    cart = []; updateCart();
    document.querySelectorAll("input,textarea").forEach(e => e.value = "");
    setTimeout(() => document.getElementById("successMsg").style.display = "none", 10000);
  })
  .catch(() => {
    document.getElementById("successMsg").style.display = "block";
    cart = []; updateCart();
    document.querySelectorAll("input,textarea").forEach(e => e.value = "");
  });
}
</script>
</body>
</html>


